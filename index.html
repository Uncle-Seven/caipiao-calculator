<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å…¨èƒ½å¤å¼æé€ŸæŸ¥è¯¢ç³»ç»Ÿ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    
    <!-- åŒæ—¶å¼•å…¥ä¸¤ä¸ªè‡ªåŠ¨åŒ–ç”Ÿæˆçš„æ•°æ®æº -->
    <script src="./ssq_data.js"></script> 
    <script src="./dlt_data.js"></script> 

    <style>
        .ball {
            display: inline-flex; justify-content: center; align-items: center;
            border-radius: 50%; color: white; font-weight: bold;
        }
        /* åŒè‰²çƒé¢œè‰² */
        .ssq-red { background: radial-gradient(circle at 30% 30%, #ff6b6b, #c0392b); box-shadow: 0 2px 4px rgba(192,57,43,0.4); }
        .ssq-blue { background: radial-gradient(circle at 30% 30%, #4facfe, #00f2fe); box-shadow: 0 2px 4px rgba(0,242,254,0.4); }
        /* å¤§ä¹é€é¢œè‰² (å‰åŒºçº¢ï¼ŒååŒºé»„/è“è°ƒ) */
        .dlt-red { background: radial-gradient(circle at 30% 30%, #ff7675, #d63031); box-shadow: 0 2px 4px rgba(214,48,49,0.4); }
        .dlt-blue { background: radial-gradient(circle at 30% 30%, #fdcb6e, #e17055); box-shadow: 0 2px 4px rgba(225,112,85,0.4); color: #2d3436; }
        * { -webkit-tap-highlight-color: transparent; }
    </style>
</head>
<body class="bg-gray-100 min-h-screen p-2 sm:p-4 md:p-8 text-gray-800">

<template id="result-template">
    <div :class="['bg-white rounded-xl md:rounded-2xl shadow-md p-4 md:p-6 border-t-4', themeClass]">
        <h2 class="text-xl md:text-2xl font-bold text-center mb-4 md:mb-6 text-gray-800">{{ title }}</h2>
        <div class="grid md:grid-cols-2 gap-4 md:gap-6 mb-6">
            <div class="bg-gray-50 p-3 md:p-4 rounded-xl border border-gray-200">
                <h3 class="text-sm md:text-base font-bold text-gray-600 mb-2 md:mb-3">æ‚¨çš„æŠ•æ³¨æ–¹æ¡ˆ</h3>
                <div class="flex flex-wrap gap-1.5 md:gap-2 mb-3">
                    <span v-for="r in parsedReds" :class="['ball w-7 h-7 md:w-9 md:h-9 text-xs md:text-sm', isDLT ? 'dlt-red' : 'ssq-red']">{{ r < 10 ? '0'+r : r }}</span>
                    <span v-for="b in parsedBlues" :class="['ball w-7 h-7 md:w-9 md:h-9 text-xs md:text-sm', isDLT ? 'dlt-blue' : 'ssq-blue']">{{ b < 10 ? '0'+b : b }}</span>
                </div>
                <div class="flex justify-between text-xs md:text-sm text-gray-600">
                    <p>æ€»æ³¨æ•°ï¼š<span class="font-bold text-black">{{ formatMoney(totalBets) }}</span> æ³¨</p>
                    <p>æˆæœ¬ï¼š<span class="font-bold text-red-600">ï¿¥{{ formatMoney(totalBets * 2) }}</span></p>
                </div>
            </div>
            <div class="bg-gray-50 p-3 md:p-4 rounded-xl border border-gray-200">
                <h3 class="text-sm md:text-base font-bold text-gray-600 mb-2 md:mb-3">
                    ç¬¬ <span class="text-red-600">{{ result.draw.issue }}</span> æœŸå¼€å¥– 
                    <span class="text-xs font-normal text-gray-400 block sm:inline">({{ result.draw.date }})</span>
                </h3>
                <div class="flex flex-wrap gap-1.5 md:gap-2 mb-3">
                    <span v-for="r in result.draw.reds" :class="['ball w-7 h-7 md:w-9 md:h-9 text-xs md:text-sm', parsedReds.includes(r) ? (isDLT ? 'dlt-red' : 'ssq-red') : 'bg-gray-300']">{{ r < 10 ? '0'+r : r }}</span>
                    <span v-for="b in result.draw.blues" :class="['ball w-7 h-7 md:w-9 md:h-9 text-xs md:text-sm', parsedBlues.includes(b) ? (isDLT ? 'dlt-blue' : 'ssq-blue') : 'bg-gray-300']">{{ b < 10 ? '0'+b : b }}</span>
                </div>
                <div class="flex justify-between text-xs md:text-sm text-gray-600">
                    <p>å‘½ä¸­å‰åŒº/çº¢ï¼š<span class="font-bold text-red-600">{{ result.matchedReds }}</span> ä¸ª</p>
                    <p>å‘½ä¸­ååŒº/è“ï¼š<span class="font-bold text-blue-600">{{ result.matchedBlues }}</span> ä¸ª</p>
                </div>
            </div>
        </div>
        
        <div class="overflow-x-auto rounded-xl border border-gray-200 shadow-sm">
            <table class="w-full text-center border-collapse text-sm md:text-base whitespace-nowrap">
                <thead>
                    <tr class="bg-gray-100 text-gray-700">
                        <th class="p-2 md:p-3 border-b font-medium">å¥–çº§</th>
                        <th class="p-2 md:p-3 border-b font-medium">å•æ³¨å¥–é‡‘</th>
                        <th class="p-2 md:p-3 border-b font-medium">ä¸­å¥–æ³¨æ•°</th>
                        <th class="p-2 md:p-3 border-b font-medium">å°è®¡é‡‘é¢</th>
                    </tr>
                </thead>
                <tbody>
                    <tr v-for="(detail, index) in result.prizeDetails" :key="index" :class="detail.count > 0 ? 'bg-yellow-50 font-bold' : 'text-gray-400'">
                        <td class="p-2 md:p-3 border-b">{{ detail.name }}</td>
                        <td class="p-2 md:p-3 border-b">ï¿¥{{ formatMoney(detail.money) }}</td>
                        <td class="p-2 md:p-3 border-b text-blue-600">{{ formatMoney(detail.count) }} æ³¨</td>
                        <td class="p-2 md:p-3 border-b text-red-600">ï¿¥{{ formatMoney(detail.total) }}</td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="mt-6 text-center text-white p-4 md:p-6 rounded-xl shadow-inner" :class="result.totalMoney > 0 ? gradientClass : 'bg-gray-400'">
            <p class="text-sm md:text-lg opacity-90">æ€»è®¡ä¸­å¥–é‡‘é¢</p>
            <p class="text-3xl md:text-5xl font-black mt-1 md:mt-2 tracking-wider">ï¿¥ {{ formatMoney(result.totalMoney) }}</p>
            <div class="mt-3 md:mt-4 pt-3 md:pt-4 border-t border-white/30 text-xs md:text-sm flex flex-wrap justify-center gap-3 md:gap-6">
                <p>æŠ•å…¥: ï¿¥{{ formatMoney(totalBets * 2) }}</p>
                <p v-if="result.totalMoney > totalBets * 2" class="font-bold text-yellow-200">ç›ˆåˆ©: ï¿¥{{ formatMoney(result.totalMoney - totalBets * 2) }} ğŸ“ˆ</p>
                <p v-else-if="result.totalMoney > 0" class="font-bold text-pink-200">äºæŸ: ï¿¥{{ formatMoney(totalBets * 2 - result.totalMoney) }} ğŸ“‰</p>
                <p v-else class="font-bold text-gray-200">è¡€æœ¬æ— å½’ ğŸ“‰</p>
            </div>
        </div>
    </div>
</template>

<div id="app" class="max-w-4xl mx-auto space-y-4 md:space-y-6 pb-10">
    
    <!-- é¡¶éƒ¨å½©ç§åˆ‡æ¢æ ‡ç­¾ -->
    <div class="flex gap-2 md:gap-4 justify-center mt-2">
        <button @click="switchGame('ssq')" :class="['flex-1 py-3 md:py-4 rounded-xl font-black text-lg md:text-xl shadow-md transition transform active:scale-95', game === 'ssq' ? 'bg-red-600 text-white' : 'bg-white text-gray-500 hover:bg-gray-50']">
            ğŸ”´ åŒè‰²çƒ
        </button>
        <button @click="switchGame('dlt')" :class="['flex-1 py-3 md:py-4 rounded-xl font-black text-lg md:text-xl shadow-md transition transform active:scale-95', game === 'dlt' ? 'bg-orange-500 text-white' : 'bg-white text-gray-500 hover:bg-gray-50']">
            ğŸŸ¡ å¤§ä¹é€
        </button>
    </div>

    <!-- æ•°æ®æºçŠ¶æ€åŒº -->
    <div class="bg-white rounded-xl shadow-md p-4 border-t-4 border-green-500 flex justify-between items-center">
        <div>
            <h2 class="text-sm md:text-lg font-bold text-gray-800 flex items-center gap-2">
                <span>ğŸ“¡ äº‘ç«¯æ•°æ® ({{ game === 'ssq' ? 'åŒè‰²çƒ' : 'å¤§ä¹é€' }})</span>
                <span v-if="currentDb.length > 0" class="text-xs bg-green-100 text-green-700 px-2 py-1 rounded-full">å·²åŠ è½½ {{ currentDb.length }} æœŸ</span>
            </h2>
            <p class="text-xs text-gray-400 mt-1" v-if="currentDb.length > 0">æœ€æ–°æœŸå·: {{ currentDb[0].issue }} ({{ currentDb[0].date }})</p>
        </div>
    </div>

    <!-- æ ¸å¿ƒè¾“å…¥ä¸è®¡ç®—åŒº -->
    <div class="bg-white rounded-xl md:rounded-2xl shadow-md p-4 md:p-6">
        <div class="space-y-4">
            <div>
                <label class="block text-gray-700 font-bold mb-1 md:mb-2 text-sm md:text-base">
                    {{ game === 'ssq' ? 'çº¢çƒ (è‡³å°‘6ä¸ª, 1-33)' : 'å‰åŒº (è‡³å°‘5ä¸ª, 1-35)' }}:
                </label>
                <textarea v-model="inputReds" rows="2" class="w-full p-3 border rounded-lg focus:ring-2 outline-none text-base md:text-lg font-bold tracking-wider resize-none" :class="game === 'ssq' ? 'border-red-300 focus:ring-red-500 text-red-600' : 'border-red-300 focus:ring-red-500 text-red-500'" placeholder="ç©ºæ ¼éš”å¼€ï¼Œå¦‚: 01 05 12 16 22 28..."></textarea>
                <div class="flex justify-between mt-1 text-xs">
                    <span class="text-red-500" v-if="parsedReds.length > 0 && parsedReds.length < rules.minR">âš ï¸ è‡³å°‘éœ€è¦ {{ rules.minR }} ä¸ª</span>
                    <span class="text-gray-500" v-else>å·²é€‰ {{ parsedReds.length }} ä¸ª</span>
                </div>
            </div>

            <div>
                <label class="block text-gray-700 font-bold mb-1 md:mb-2 text-sm md:text-base">
                    {{ game === 'ssq' ? 'è“çƒ (è‡³å°‘1ä¸ª, 1-16)' : 'ååŒº (è‡³å°‘2ä¸ª, 1-12)' }}:
                </label>
                <input v-model="inputBlues" type="text" class="w-full p-3 border rounded-lg focus:ring-2 outline-none text-base md:text-lg font-bold tracking-wider" :class="game === 'ssq' ? 'border-blue-300 focus:ring-blue-500 text-blue-600' : 'border-yellow-400 focus:ring-yellow-500 text-yellow-600'" placeholder="ä¾‹å¦‚: 03 12">
                <div class="flex justify-between mt-1 text-xs">
                    <span class="text-red-500" v-if="parsedBlues.length > 0 && parsedBlues.length < rules.minB">âš ï¸ è‡³å°‘éœ€è¦ {{ rules.minB }} ä¸ª</span>
                    <span class="text-gray-500" v-else>å·²é€‰ {{ parsedBlues.length }} ä¸ª</span>
                </div>
            </div>

            <div>
                <label class="block text-gray-700 font-bold mb-1 md:mb-2 text-sm md:text-base">æŒ‡å®šæœŸå·æŸ¥è¯¢ (ç•™ç©ºç®—æœ€æ–°ä¸€æœŸ):</label>
                <input v-model="targetIssue" type="number" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-500 outline-none text-base" placeholder="ä¾‹å¦‚: 2026021">
            </div>

            <button @click="calculatePrize" :disabled="!canCalculate" :class="['w-full text-white font-bold py-3 md:py-4 rounded-xl shadow-lg transition duration-200 text-base md:text-lg active:scale-95 disabled:bg-gray-400', game === 'ssq' ? 'bg-red-600 hover:bg-red-700' : 'bg-orange-500 hover:bg-orange-600']">
                <span v-if="!canCalculate">è¯·å®Œå–„å·ç åŠæ•°æ®æº</span>
                <span v-else>ç«‹å³è®¡ç®—ä¸­å¥–ç»“æœ ğŸš€</span>
            </button>
        </div>
    </div>

    <!-- ç»“æœå±•ç¤ºåŒº -->
    <div id="result-area" class="space-y-4 md:space-y-6 scroll-mt-4">
        <result-card 
            v-if="currentResult"
            title="ğŸ‰ æœ¬æœŸæŸ¥è¯¢ç»“æœ ğŸ‰"
            theme-class="border-yellow-400"
            :gradient-class="game === 'ssq' ? 'bg-gradient-to-r from-red-500 to-red-600' : 'bg-gradient-to-r from-orange-400 to-orange-500'"
            :is-d-l-t="game === 'dlt'"
            :result="currentResult" :parsed-reds="parsedReds" :parsed-blues="parsedBlues" :total-bets="totalBets">
        </result-card>

        <result-card 
            v-if="historyMaxResult && (!currentResult || historyMaxResult.draw.issue !== currentResult.draw.issue)"
            title="ğŸ‘‘ å†å²æ•°æ®ä¸­æœ€é«˜å¥–é‡‘æœŸå· ğŸ‘‘"
            theme-class="border-purple-500"
            gradient-class="bg-gradient-to-r from-purple-500 to-indigo-600"
            :is-d-l-t="game === 'dlt'"
            :result="historyMaxResult" :parsed-reds="parsedReds" :parsed-blues="parsedBlues" :total-bets="totalBets">
        </result-card>
    </div>
</div>

<script>
const { createApp } = Vue;

function C(n, m) {
    if (m < 0 || m > n) return 0;
    if (m === 0 || m === n) return 1;
    let res = 1;
    for (let i = 1; i <= m; i++) { res = res * (n - i + 1) / i; }
    return res;
}

const ResultCard = {
    template: '#result-template',
    props: ['result', 'parsedReds', 'parsedBlues', 'totalBets', 'title', 'themeClass', 'gradientClass', 'isDLT'],
    methods: { formatMoney(num) { return num.toLocaleString('zh-CN'); } }
};

createApp({
    components: { 'result-card': ResultCard },
    data() {
        return {
            game: 'ssq', // 'ssq' | 'dlt'
            ssqDb: [],
            dltDb: [],
            inputReds: '01 05 12 16 22 28 30 31', 
            inputBlues: '03 04 12',
            targetIssue: '',
            currentResult: null,
            historyMaxResult: null
        }
    },
    computed: {
        rules() {
            return this.game === 'ssq' 
                ? { maxR: 33, maxB: 16, minR: 6, minB: 1 } 
                : { maxR: 35, maxB: 12, minR: 5, minB: 2 };
        },
        currentDb() { return this.game === 'ssq' ? this.ssqDb : this.dltDb; },
        parsedReds() { return [...new Set(this.inputReds.split(/[\s,ï¼Œã€]+/).map(Number).filter(n => n >= 1 && n <= this.rules.maxR))].sort((a, b) => a - b); },
        parsedBlues() { return [...new Set(this.inputBlues.split(/[\s,ï¼Œã€]+/).map(Number).filter(n => n >= 1 && n <= this.rules.maxB))].sort((a, b) => a - b); },
        canCalculate() { return this.parsedReds.length >= this.rules.minR && this.parsedBlues.length >= this.rules.minB && this.currentDb.length > 0; },
        totalBets() { return C(this.parsedReds.length, this.rules.minR) * C(this.parsedBlues.length, this.rules.minB); }
    },
    mounted() {
        this.parseAllData();
    },
    methods: {
        switchGame(type) {
            this.game = type;
            this.currentResult = null;
            this.historyMaxResult = null;
            this.targetIssue = '';
            // åˆ‡æ¢æ—¶ç»™ä¸ªé»˜è®¤ç¤ºä¾‹å·ç 
            if(type === 'ssq') { this.inputReds = '01 05 12 16 22 28 30 31'; this.inputBlues = '03 04 12'; }
            else { this.inputReds = '02 08 15 23 29 32 35'; this.inputBlues = '04 07 11'; }
        },
        parseAllData() {
            // è§£æåŒè‰²çƒ
            if (typeof window.SSQ_ONLINE_DATA !== 'undefined') {
                this.ssqDb = window.SSQ_ONLINE_DATA.trim().split('\n').reverse().map(line => {
                    const c = line.trim().split(/\s+/);
                    if(c.length < 29) return null;
                    return { issue: c[0], date: c[1], reds: c.slice(2, 8).map(Number), blues: [Number(c[8])],
                        prizes: [Number(c[18]), Number(c[20]), Number(c[22]), Number(c[24]), Number(c[26]), Number(c[28])] };
                }).filter(Boolean);
            }
            // è§£æå¤§ä¹é€ (å¤§ä¹é€å¥–çº§å¤šï¼Œç®€åŒ–æ˜ å°„å‰6çº§ä¾¿äºå±•ç¤º)
            if (typeof window.DLT_ONLINE_DATA !== 'undefined') {
                this.dltDb = window.DLT_ONLINE_DATA.trim().split('\n').reverse().map(line => {
                    const c = line.trim().split(/\s+/);
                    if(c.length < 25) return null;
                    return { issue: c[0], date: c[1], reds: c.slice(2, 7).map(Number), blues: c.slice(7, 9).map(Number),
                        // å¤§ä¹é€å–å‰6ä¸ªä¸»è¦å¥–é‡‘çº§åˆ«
                        prizes: [Number(c[14]), Number(c[16]), Number(c[18]), Number(c[20]), Number(c[22]), Number(c[24])] };
                }).filter(Boolean);
            }
        },
        calculateSingleDraw(draw) {
            const R = this.parsedReds.length, B = this.parsedBlues.length;
            const m = this.parsedReds.filter(x => draw.reds.includes(x)).length;
            const n = this.parsedBlues.filter(x => draw.blues.includes(x)).length;

            const calc = (reqR, reqB) => C(m, reqR) * C(R - m, this.rules.minR - reqR) * C(n, reqB) * C(B - n, this.rules.minB - reqB);
            
            let details = [];
            if (this.game === 'ssq') {
                details = [
                    { name: 'ä¸€ç­‰å¥–', count: calc(6, 1), money: draw.prizes[0] },
                    { name: 'äºŒç­‰å¥–', count: calc(6, 0), money: draw.prizes[1] },
                    { name: 'ä¸‰ç­‰å¥–', count: calc(5, 1), money: draw.prizes[2] },
                    { name: 'å››ç­‰å¥–', count: calc(5, 0) + calc(4, 1), money: draw.prizes[3] },
                    { name: 'äº”ç­‰å¥–', count: calc(4, 0) + calc(3, 1), money: draw.prizes[4] },
                    { name: 'å…­ç­‰å¥–', count: calc(2, 1) + calc(1, 1) + calc(0, 1), money: draw.prizes[5] }
                ];
            } else {
                // å¤§ä¹é€å¥–çº§è®¡ç®— (å‰6çº§)
                details = [
                    { name: 'ä¸€ç­‰å¥–(5+2)', count: calc(5, 2), money: draw.prizes[0] },
                    { name: 'äºŒç­‰å¥–(5+1)', count: calc(5, 1), money: draw.prizes[1] },
                    { name: 'ä¸‰ç­‰å¥–(5+0)', count: calc(5, 0), money: draw.prizes[2] },
                    { name: 'å››ç­‰å¥–(4+2)', count: calc(4, 2), money: draw.prizes[3] },
                    { name: 'äº”ç­‰å¥–(4+1)', count: calc(4, 1), money: draw.prizes[4] },
                    { name: 'å…­ç­‰åŠä»¥ä¸‹', count: calc(3, 2) + calc(4, 0) + calc(3, 1) + calc(2, 2) + calc(3, 0) + calc(1, 2) + calc(2, 1) + calc(0, 2), money: draw.prizes[5] || 5 }
                ];
            }

            let totalMoney = 0;
            details.forEach(d => { d.total = d.count * d.money; totalMoney += d.total; });

            return { draw, matchedReds: m, matchedBlues: n, prizeDetails: details, totalMoney };
        },
        calculatePrize() {
            let targetDraw = this.targetIssue.trim() ? this.currentDb.find(d => d.issue === this.targetIssue.trim()) : this.currentDb[0];
            if (!targetDraw) return alert(`æœªæ‰¾åˆ°æœŸå· ${this.targetIssue}`);
            
            this.currentResult = this.calculateSingleDraw(targetDraw);

            let maxMoney = -1, bestResult = null;
            for (const draw of this.currentDb) {
                const res = this.calculateSingleDraw(draw);
                if (res.totalMoney > maxMoney) { maxMoney = res.totalMoney; bestResult = res; }
            }
            this.historyMaxResult = maxMoney > 0 ? bestResult : null;

            this.$nextTick(() => document.getElementById('result-area').scrollIntoView({ behavior: 'smooth' }));
        }
    }
}).mount('#app')
</script>
</body>
</html>
